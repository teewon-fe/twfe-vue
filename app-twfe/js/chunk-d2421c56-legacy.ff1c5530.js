(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2421c56"],{"4ec0":function(e,t,n){"use strict";var s=n("ec9e"),r=n.n(s);r.a},"51f1":function(e,t,n){var s=n("e46b");s(s.P,"String",{repeat:n("f160")})},ec9e:function(e,t,n){},eefd:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"bottom",rawName:"v-bottom",value:0,expression:"0"}],staticClass:"tw-loginbox",on:{click:e.focusInput}},[n("div",[e._v("登录或注册(请用真实姓名)")]),e._l(e.cmdContent,(function(t,s){return n("div",{key:s},[e._v(e._s(t))])})),n("div",[n("span",[e._v("$:")]),"checkbox"===("enter-password"===e.step?"password":"text")?n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"input",staticClass:"tw-loginbox-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCmd(t)},change:function(t){var n=e.value,s=t.target,r=!!s.checked;if(Array.isArray(n)){var o=null,i=e._i(n,o);s.checked?i<0&&(e.value=n.concat([o])):i>-1&&(e.value=n.slice(0,i).concat(n.slice(i+1)))}else e.value=r}}}):"radio"===("enter-password"===e.step?"password":"text")?n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"input",staticClass:"tw-loginbox-input",attrs:{type:"radio"},domProps:{checked:e._q(e.value,null)},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCmd(t)},change:function(t){e.value=null}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"input",staticClass:"tw-loginbox-input",attrs:{type:"enter-password"===e.step?"password":"text"},domProps:{value:e.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCmd(t)},input:function(t){t.target.composing||(e.value=t.target.value)}}})])],2)},r=[],o=(n("5ab2"),n("6d57"),n("e10e"),n("f548"),n("ce3c"));n("51f1");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={name:"page-login",data:function(){return{cmdContent:["请输入用户名"],step:"enter-user",value:"",params:{username:"",password:"",mob:""}}},methods:{focusInput:function(){this.$refs.input.focus()},nextCmd:function(e,t){t?this.cmdContent.push("$:".concat("*".repeat(this.value.length))):this.cmdContent.push("$:".concat(this.value)),this.cmdContent.push(e),this.value=""},handleLoginSuccess:function(e){var t=e.role&&e.role!==this.$cnt.ROLE_TEAM_LEADER?"":e.userGroup;window.$ui.setDefaultHeaders({token:e.token,"user-id":e.userId,"global-dev-group":t}),window.$app.setAuth(a({username:this.$api.user.getSession.params.username,globalDevGroup:t},e),null,720),this.$router.push("/home")},login:function(e){var t=this;this.$api.user.getSession.send(e||this.params).then((function(e){t.handleLoginSuccess(e)})).catch((function(e){"3001"===e.resultCode?(t.nextCmd("密码错误，请重新输入用户名",!0),t.step="enter-user"):"3002"===e.resultCode&&(t.nextCmd("请输入手机号码",!0),t.step="enter-mob")}))},handleCmd:function(){var e=this;"enter-user"===this.step?this.value.trim()?(this.params.username=this.value,this.nextCmd("请输入密码"),this.step="enter-password"):this.cmdContent.push("请输入用户名"):"enter-password"===this.step?this.value.trim()?(this.params.password=btoa(this.value).replace(/=+$/g,""),this.login()):this.cmdContent.push("请输入用户密码"):"enter-mob"===this.step&&(this.value.trim()?this.$ui.pattern.phone.test(this.value)?(this.params.mob=this.value,this.$api.user.addUser.send(this.params).then((function(t){e.handleLoginSuccess(t)}))):this.cmdContent.push("请输入正确的手机号码"):this.cmdContent.push("第一次登录需输入手机号码")),this.$nextTick((function(){window.scrollTo(0,document.documentElement.offsetHeight+10)}))}},mounted:function(){this.focusInput()},created:function(){"twfe"===this.$route.query.from&&this.login(this.$route.query)}},c=u,l=(n("4ec0"),n("9ca4")),p=Object(l["a"])(c,s,r,!1,null,null,null);t["default"]=p.exports},f160:function(e,t,n){"use strict";var s=n("ee21"),r=n("f6b4");e.exports=function(e){var t=String(r(this)),n="",o=s(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}}}]);
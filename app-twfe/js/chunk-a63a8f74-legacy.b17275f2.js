(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a63a8f74"],{"1c9a":function(t,e,s){},e055:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"tw-body"},[s("div",{staticClass:"tw-body-inner xcontainer"},[s("div",{staticClass:"tw-crm"},[s("router-link",{staticClass:"tw-crm-link",attrs:{to:"/home"}},[t._v("项目列表")]),s("i",{staticClass:"tw-crm-arrow"}),s("span",{staticClass:"tw-crm-self ml-step"},[t._v(t._s(t.project.project_name))])],1),s("div",{staticClass:"tw-card mb-medium pb-medium"},[s("div",{staticClass:"tw-title xnomark xico"},[s("div",{staticClass:"tw-title-left"},[s("i",{staticClass:"tw-ico xeco xsmall"}),s("span",{staticClass:"text-default"},[t._v(t._s(t.project.project_name))])]),s("div",{staticClass:"tw-title-right"},[t.$app.user.role===t.$cnt.ROLE_TEAM_LEADER?[s("router-link",{staticClass:"tw-icobtn",attrs:{to:"/new-project?id="+t.$route.query.id}},[s("i",{staticClass:"tw-ico xedit"}),t._v("编辑")]),s("a",{staticClass:"tw-icobtn",on:{click:t.delProject}},[s("i",{staticClass:"tw-ico xdel"}),t._v("删除")])]:t._e()],2)]),s("div",{staticClass:"tw-grid xpc4 xlpad4 xpad4 text-center"},[t.leader?s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-large"},[t._v(t._s(t.leader.name||"--"))]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v(t._s(t.leader.mobile||"--")+"(手机)")]),t._m(0)]):t._e(),!t.$app.testVersion.includes("twfe")&&t.feLeader?s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-large"},[t._v(t._s(t.feLeader.name||"--"))]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v(t._s(t.feLeader.mobile||"--")+"(手机)")]),t._m(1)]):t._e(),s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v(t._s(t.project.invested_time))]),t._v("/"+t._s(t.project.task_time))]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("已投入/总工时(人天)")]),t._m(2)]),t.$app.testVersion.includes("twfe")?s("div",{staticClass:"tw-grid-col"},[t._m(3),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("当前/目标(页/人天)")]),t._m(4)]):t._e(),t._m(5)])]),s("div",{directives:[{name:"bottom",rawName:"v-bottom",value:70,expression:"70"}],staticClass:"tw-card xradius px-medium pb-huge"},[s("div",{staticClass:"tw-title"},[s("h3",{staticClass:"tw-title-left text-default"},[t._v("项目详情")]),s("div",{staticClass:"tw-title-right"},[s("ul",{staticClass:"tw-steps xstripe"},t._l(t.project.timeNodes,(function(e,r){return s("li",{key:r,staticClass:"tw-steps-item",class:{xdone:"done"===e.status,xactive:"active"===e.status,xrisk:"risk"===e.status},style:"z-index:"+(t.project.timeNodes.length-r)+";"},[s("span",[t._v(t._s(e.text))]),e.status&&"risk"!==e.status||!e.time_node_name.includes("转测")?t._e():s("a",{staticClass:"text-link",staticStyle:{"margin-right":"-5px","padding-left":"5px"}},[t._v("转测")])])})),0)])]),s("div",{staticClass:"text-small"},[s("a",{staticClass:"tw-tag xsmall dt-n1 p-0 mr-step",class:{xrisk:"risky"===t.project.status,xnormal:"risky"!==t.project.status}}),"risky"===t.project.status?s("span",{staticClass:"text-secondary"},[s("span",[t._v("有风险, 进度延期"+t._s(t.project.delay)+"天("+t._s(parseInt(t.project.expectant_progress-t.project.progress))+"%)；")]),t._l(t.project.delayDevelopers,(function(e,r){return s("span",{key:r},[s("span",[t._v("【"+t._s(e.developer_name)+"】延期")]),s("span",{staticClass:"text-bold"},[t._v(t._s(e.delay)+"天")]),r<t.project.delayDevelopers.length-1?s("span",[t._v(",")]):t._e()])}))],2):s("span",[t._v(t._s(t.$dic.select(t.$dic.projectStatus,t.project.status)))])]),s("div",{staticClass:"tw-flex align-items-center text-center"},[s("div",{staticStyle:{width:"30%"}},[s("el-progress",{attrs:{type:"circle",width:150,percentage:t.project.progress,"stroke-width":8,color:"risky"===t.project.status?"#f56c6c":"#218fff"}})],1),s("div",{staticClass:"tw-flex-body"},[s("tw-chart",{attrs:{height:"240px",categoryKey:"developer_name",option:{legend:{show:!1},tooltip:{formatter:"{b}<br />完成：{c}%"}},dataMaps:t.project.chartDataMaps}})],1)]),s("tw-collapse-group",[s("div",{staticClass:"text-center mt-medium"},[s("ul",{staticClass:"tw-btngroup"},[s("li",{staticClass:"js-project1-schedule"},[s("a",{staticClass:"tw-btn xweaking"},[t._v("进度详情")])]),s("li",{staticClass:"js-project1-info"},[s("a",{staticClass:"tw-btn xweaking"},[t._v("项目信息")])])])]),[t.$cnt.ROLE_TEAM_LEADER].includes(t.$app.user.role)||t.project&&t.project.developer_ids&&t.project.developer_ids.includes(t.$app.user.userId)?s("div",{staticClass:"text-right"},[t.progressInputVisibal?s("a",{staticClass:"text-link",on:{click:t.closeModify}},[t._v("修改完成")]):s("a",{staticClass:"text-link",on:{click:function(e){t.progressInputVisibal=!0}}},[t._v("修改进度")])]):t._e(),s("tw-collapse",{attrs:{"default-open":"",switch:".js-project1-schedule"}},[s("div",{staticClass:"tw-twrapper mt-step"},[s("table",{staticClass:"tw-table xnowrap xprogress"},[s("thead",[s("tr",[s("th",{staticStyle:{width:"4em"}},[t._v("序号")]),s("th",{staticStyle:{width:"300px"}},[t._v("任务名称")]),s("th",[t._v("开发")]),s("th",{staticStyle:{width:"150px"}},[t._v("进度")]),s("th",[t._v("难度等级")]),s("th",{staticStyle:{width:"70px"}},[t._v("工时")]),s("th",{staticStyle:{width:"130px"}},[t._v("开始时间")]),s("th",{staticStyle:{width:"130px"}},[t._v("完成时间")])])]),s("tbody",[t._l(t.project.plans,(function(e,r){return["group"===e.task_type?s("tr",{key:e.id},[s("td",{staticClass:"text-bold",attrs:{colspan:"8"}},[t._v(t._s(e.task_name))])]):s("tr",{key:e.id},[s("td",[t._v(t._s(r-t.getOffsetIdx(r)))]),s("td",[t._v(t._s(e.task_name))]),s("td",[t._v(t._s(e.developer_name))]),s("td",[t.progressInputVisibal&&(e.developer_id===t.$app.user.userId||[t.$cnt.ROLE_TEAM_LEADER].includes(t.$app.user.role))?s("el-select",{attrs:{size:"mini"},on:{change:function(s){return t.$api.project.updatePlan.send({id:e.id,progress:e.progress})}},model:{value:e.progress,callback:function(s){t.$set(e,"progress",s)},expression:"plan.progress"}},t._l(t.$dic.progressList,(function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):s("el-progress",{attrs:{percentage:100*e.progress,format:t.format,color:"risky"===e.status?"#f56c6c":"#218fff"}})],1),s("td",[t._v(t._s(t.$dic.select(t.$api.dic.degreens.data.list,e.degreen,"degreen_name")))]),s("td",[t._v(t._s(e.task_time))]),s("td",[t._v(t._s(t.$ui.dateFormat(e.start_time,"yyyy-mm-dd HH:MM")))]),s("td",[t._v(t._s(t.$ui.dateFormat(e.end_time,"yyyy-mm-dd HH:MM")))])])]}))],2)])])]),s("tw-collapse",{attrs:{switch:".js-project1-info"}},[s("div",{staticClass:"tw-twrapper mt-medium"},[s("table",{staticClass:"tw-table"},[s("thead",[s("tr",[s("th",{staticStyle:{width:"200px"}},[t._v("项目相关url")]),s("th",[t._v("url")])])]),s("tbody",[t.project.project_svn?s("tr",[s("td",[t._v("项目SVN目录")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_svn,target:"_blank"}},[t._v(t._s(t.project.project_svn))])])]):t._e(),t.project.project_prd_url?s("tr",[s("td",[t._v("需求文档地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_prd_url,target:"_blank"}},[t._v(t._s(t.project.project_prd_url))])])]):t._e(),t.project.project_design_svn?s("tr",[s("td",[t._v("高保真SVN")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_design_svn,target:"_blank"}},[t._v(t._s(t.project.project_design_svn))])])]):t._e(),t.project.project_psd_svn?s("tr",[s("td",[t._v("设计源文件SVN")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_psd_svn,target:"_blank"}},[t._v(t._s(t.project.project_psd_svn))])])]):t._e(),t.project.project_api_svn?s("tr",[s("td",[t._v("接口文档地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_api_svn,target:"_blank"}},[t._v(t._s(t.project.project_api_svn))])])]):t._e(),t.project.project_test_case_svn?s("tr",[s("td",[t._v("测试用例地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_test_case_svn,target:"_blank"}},[t._v(t._s(t.project.project_test_case_svn))])])]):t._e(),t.project.remark?s("tr",[s("td",[t._v("备注")]),s("td",[s("pre",[t._v(t._s(t.project.remark))])])]):t._e()])])])])],1)],1)])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xdev dt-n1 mr-3"}),t._v("开发负责人")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xfe dt-n1 mr-3",staticStyle:{"margin-right":"-3px"}}),t._v("前端负责人")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xcmonth dt-n1 mr-3"}),t._v("项目工时")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v("--")]),t._v("/1.5")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xspeed dt-n1 mr-3"}),t._v("项目效率")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v("--")]),t._v("/--")]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("本月/总数(个)")]),s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xbug dt-n1 mr-3"}),t._v("项目缺陷")])])}],i=(s("5ab2"),s("e10e"),s("309f"),s("0b53"),s("06a2"),s("ec25"),s("cc57"),s("2b45"),s("f548"),s("ce3c"));s("6d57");function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function n(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){Object(i["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function o(t,e){var s;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=l(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,n=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return c=t.done,t},e:function(t){n=!0,i=t},f:function(){try{c||null==s.return||s.return()}finally{if(n)throw i}}}}function l(t,e){if(t){if("string"===typeof t)return p(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,r=new Array(e);s<e;s++)r[s]=t[s];return r}var d={name:"page-project-detail",data:function(){return{progressInputVisibal:!1}},computed:{planGroupIndexes:function(){var t=[];return this.project.plans.forEach((function(e,s){"group"===e.task_type&&t.push(s)})),t},project:function(){if(this.$api.project.getProjects.data.list[0]){var t,e=this.$api.project.getProjects.data.list[0],s=[],r=o(e.developers);try{for(r.s();!(t=r.n()).done;){var a=t.value;s.push(a.progress<a.expectant_progress?"#fb6c84":"#218fff")}}catch(i){r.e(i)}finally{r.f()}return e.developers.forEach((function(t){return t.total=100})),n(n({},e.project),{},{delayDevelopers:e.developers.filter((function(t){return t.delay>0})),timeNodes:e.timeNodes,plans:e.plans,chartDataMaps:[{name:"百分比",type:"bar",dataset:e.developers,dataKey:"total",barWidth:30,barGap:"-100%",itemStyle:{normal:{color:"#ebeef5"},barBorderRadius:0},tooltip:{show:!1}},{name:"已完成",type:"bar",dataset:e.developers,dataKey:"progress",barWidth:30,itemStyle:{barBorderRadius:0},colors:s}]})}return{plans:[],timeNodes:[],chartData:[],chartDataMaps:[]}},leader:function(){return this.$api.user.getUsers.data.list.length>0?this.$ui.arr.findMode(this.$api.user.getUsers.data.list,{id:this.project.project_leader_id})[0]:{}},feLeader:function(){return this.$api.user.getUsers.data.list.length>0?this.$ui.arr.findMode(this.$api.user.getUsers.data.list,{id:this.project.project_fe_leader_id})[0]:{}}},methods:{format:function(t){return"".concat(t,"%")},getProject:function(){var t=this;this.$api.project.getProjects.reset().send({id:this.$route.query.id}).then((function(e){if(e.list&&e.list[0]){var s=e.list[0].project;s.dev_group&&t.$api.user.getUsers.send({groupIds:s.dev_group})}}))},getOffsetIdx:function(t){for(var e=0;e<this.planGroupIndexes.length;e++)if(t<this.planGroupIndexes[e])break;return e-1},delProject:function(){var t=this;this.$prompt("该删除为物理删除，不可恢复，请输入登录密码继续：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{6}/,inputErrorMessage:"请输入密码",inputPlaceholder:"请输入您的登录密码"}).then((function(e){var s=e.value;t.$api.project.del.send({pwd:btoa(s).replace(/=+$/g,""),id:t.$route.query.id}).then((function(e){t.$ui.msg("删除成功"),t.$router.push("/")})).catch((function(e){t.$ui.msg({type:"error",message:"删除失败"})}))})).catch((function(){}))},closeModify:function(){this.progressInputVisibal=!1,this.getProject()}},created:function(){this.$route.query.id?(this.getProject(),this.$api.dic.degreens.send()):this.$router.push("/")}},u=d,_=(s("f6ac"),s("9ca4")),v=Object(_["a"])(u,r,a,!1,null,null,null);e["default"]=v.exports},f6ac:function(t,e,s){"use strict";var r=s("1c9a"),a=s.n(r);a.a}}]);